(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     71037,       1426]
NotebookOptionsPosition[     67195,       1366]
NotebookOutlinePosition[     67588,       1382]
CellTagsIndexPosition[     67545,       1379]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Import raw coordinates", "Section",
 CellChangeTimes->{{3.8073718646316843`*^9, 3.807371871032054*^9}, {
  3.821055205607613*^9, 
  3.821055213101309*^9}},ExpressionUUID->"81fbbc38-d5ef-4a5b-8324-\
04a5f75e981c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"rawCoordinates", " ", "=", " ", 
   RowBox[{
   "Import", "[", 
    "\"\</Users/katjad/Documents/Github/SheepCapstone/MXs/\
ProcessedCoordinates/rawCoordinates.mx\>\"", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.821055200709333*^9, 3.821055229212986*^9}, 
   3.821056229246149*^9},ExpressionUUID->"70b09186-4e39-46c9-8cae-\
3d5dd19b0464"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Sticky DBScan", "Section",
 CellChangeTimes->{{3.8209514131597567`*^9, 
  3.820951418286989*^9}},ExpressionUUID->"b2fc9f7d-00eb-441f-8736-\
15e45197167f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Output", ":", " ", 
      RowBox[{
      "clusters", " ", "for", " ", "the", " ", "sheep", " ", "as", " ", 
       "traditional", " ", "DBSCAN", " ", "but", " ", "with", " ", "sheep", 
       " ", "tending", " ", "to", " ", "\"\<stick\>\"", " ", "to", " ", "the",
        " ", "group", " ", "they", " ", "are", " ", "already", " ", 
       RowBox[{"with", ".", " ", "If"}], " ", "r1"}]}], "=", "r2"}], ",", " ", 
    RowBox[{"equivalent", " ", "to", " ", "DBSCAN", "\[IndentingNewLine]", 
     RowBox[{"Inputs", ":", " ", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"-", " ", "pts"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"locations", " ", "of", " ", "the", " ", "sheep"}], ",", 
          " ", 
          RowBox[{"2", "D"}], ",", " ", 
          RowBox[{"list", " ", "of", " ", "list"}]}], ")"}]}], 
       "\[IndentingNewLine]", "-", " ", 
       RowBox[{"r1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
          "smaller", " ", "of", " ", "the", " ", "two", " ", "radii"}], ",", 
          " ", 
          RowBox[{"sheep", " ", "are", " ", "considered", " ", "together"}]}],
          ")"}]}], "\[IndentingNewLine]", "-", 
       RowBox[{"r2", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"larger", " ", "of", " ", "the", " ", "two", " ", "radii"}],
           ",", " ", 
          RowBox[{
          "sheep", " ", "are", " ", "considered", " ", "together", " ", 
           "only", " ", "if", " ", "they", " ", "were", " ", "in", " ", "the",
            " ", "same", " ", "group", " ", "in", " ", "the", " ", "last", 
           " ", "time", " ", "step"}]}], ")"}]}], "\[IndentingNewLine]", "-", 
       " ", 
       RowBox[{"k", " ", 
        RowBox[{"(", 
         RowBox[{"minimum", " ", "number", " ", "of", " ", "neighbors", 
          RowBox[{"(", 
           RowBox[{"including", " ", "oneself"}], ")"}], " ", "to", " ", "be",
           " ", "considered", " ", "a", " ", "core", " ", "point"}], ")"}]}], 
       "\[IndentingNewLine]", "-", " ", 
       RowBox[{"indexPrevClusters", " ", 
        RowBox[{"(", 
         RowBox[{
         "Association", " ", "from", " ", "each", " ", "cluster", " ", "to", 
          " ", "the", " ", "neighbors", " ", "in", " ", "the", " ", 
          "previous", " ", "cluster"}], ")"}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"dbscanSticky", "[", 
    RowBox[{"pts_", ",", 
     RowBox[{"{", 
      RowBox[{"r1_", ",", "r2_"}], "}"}], ",", "k_", ",", 
     "indexPrevClusters_"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "indexPts", ",", "nf", ",", "pointNeighbors", ",", "coreIndices", ",", 
       "clusterCores", ",", "coreClusters", ",", "noncoreIndices", ",", 
       "clusterNoncores"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
       "Turn", " ", "points", " ", "into", " ", "association", " ", "with", 
        " ", "the", " ", "correct", " ", "index"}], ",", " ", 
       RowBox[{"delete", " ", "missing", " ", "points"}]}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"indexPts", "=", 
       RowBox[{"DeleteMissing", "[", 
        RowBox[{
         RowBox[{"AssociationThread", "[", 
          RowBox[{
           RowBox[{"Range", "[", 
            RowBox[{"Length", "[", "pts", "]"}], "]"}], ",", "pts"}], "]"}], 
         ",", "1", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Define", " ", "nearest", " ", "function"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"nf", "=", 
       RowBox[{"Nearest", "[", "indexPts", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"For", " ", "each", " ", "point"}], ",", " ", 
        RowBox[{"find", " ", "its", " ", "neighbors"}], ",", " ", 
        RowBox[{
        "considering", " ", "whether", " ", "they", " ", "were", " ", 
         "neighbors", " ", "in", " ", "the", " ", "previous", " ", "time", 
         " ", "step", " ", "or", " ", "not"}]}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"pointNeighbors", "=", "\[IndentingNewLine]", 
       RowBox[{"Association", "[", 
        RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"#2", "\[Rule]", 
            RowBox[{"With", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"prevNeighbors", "=", 
                RowBox[{"indexPrevClusters", "[", "#2", "]"}]}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Select", "[", 
               RowBox[{"#1", ",", 
                RowBox[{"Function", "[", 
                 RowBox[{"n", ",", "\[IndentingNewLine]", 
                  RowBox[{"With", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"d", "=", 
                    RowBox[{"EuclideanDistance", "[", 
                    RowBox[{
                    RowBox[{"indexPts", "[", "#2", "]"}], ",", 
                    RowBox[{"indexPts", "[", "n", "]"}]}], "]"}]}], "}"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"prevNeighbors", ",", "n"}], "]"}], ",", 
                    RowBox[{"d", "\[LessEqual]", "r2"}], ",", 
                    RowBox[{"d", "\[LessEqual]", "r1"}]}], "]"}]}], 
                   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
                 "]"}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}], "&"}], ",",
           "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"nf", "[", 
              RowBox[{
               RowBox[{"Values", "[", "indexPts", "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"All", ",", "r"}], "}"}]}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", 
               RowBox[{"2", ";;"}]}], "]"}], "]"}], ",", 
            RowBox[{"Keys", "[", "indexPts", "]"}]}], "}"}]}], 
         "\[IndentingNewLine]", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Find", " ", "all", " ", "core", " ", "points"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"coreIndices", "=", 
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{"pointNeighbors", ",", 
          RowBox[{"_", "?", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Length", "[", "#", "]"}], "+", "1"}], 
              "\[GreaterEqual]", "k"}], "&"}], ")"}]}], ",", 
          RowBox[{"{", "1", "}"}], ",", 
          RowBox[{"Heads", "\[Rule]", "False"}]}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "1", ",", "1"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Form", " ", "the", " ", "clusters", " ", "just", " ", "from", " ", 
        "the", " ", "core", " ", "points"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"clusterCores", "=", "\[IndentingNewLine]", 
       RowBox[{"ConnectedComponents", "[", "\[IndentingNewLine]", 
        RowBox[{"Catenate", "[", 
         RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"#1", "\[Rule]", "#2"}], "]"}], "&"}], ",", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{"coreIndices", ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Select", "[", 
               RowBox[{
                RowBox[{"MemberQ", "[", 
                 RowBox[{"coreIndices", ",", "#"}], "]"}], "&"}], "]"}], "/@", 
              RowBox[{"Lookup", "[", 
               RowBox[{"pointNeighbors", ",", "coreIndices"}], "]"}]}]}], 
            "\[IndentingNewLine]", "}"}]}], "]"}], "]"}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"coreClusters", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Catenate", "[", 
         RowBox[{"MapIndexed", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"#1", "\[Rule]", 
              RowBox[{"First", "[", "#2", "]"}]}], "]"}], "&"}], ",", 
           "clusterCores"}], "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Consider", " ", "all", " ", "points", " ", "that", " ", "are", " ", 
        "not", " ", "cores"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"noncoreIndices", "=", 
       RowBox[{"Complement", "[", 
        RowBox[{
         RowBox[{"Keys", "[", "indexPts", "]"}], ",", "coreIndices"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "if", " ", "they", " ", "could", " ", "be", " ", "in", " ", "more", 
         " ", "than", " ", "one", " ", "cluster"}], ",", " ", 
        RowBox[{"chose", " ", "randomly"}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"clusterNoncores", "=", 
       RowBox[{"Merge", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Lookup", "[", 
             RowBox[{"coreClusters", ",", 
              RowBox[{"pointNeighbors", "[", "#", "]"}], ",", "Nothing"}], 
             "]"}], "\[Rule]", "#"}], "&"}], "/@", "noncoreIndices"}], ",", 
         "Identity"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"KeyValueMap", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"With", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"c", "=", 
             RowBox[{"RandomChoice", "[", "#1", "]"}]}], "}"}], ",", 
           RowBox[{
            RowBox[{"clusterCores", "[", 
             RowBox[{"[", "c", "]"}], "]"}], "=", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"clusterCores", "[", 
               RowBox[{"[", "c", "]"}], "]"}], ",", "#2"}], "]"}]}]}], "]"}], 
         "&"}], ",", "\[IndentingNewLine]", 
        RowBox[{"KeyDrop", "[", 
         RowBox[{"clusterNoncores", ",", 
          RowBox[{"Key", "[", 
           RowBox[{"{", "}"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", "]"}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "Return", " ", "the", " ", "full", " ", "set", " ", "of", " ", 
         "clusters"}], ",", " ", 
        RowBox[{
        "add", " ", "an", " ", "empty", " ", "list", " ", "if", " ", "none", 
         " ", "of", " ", "the", " ", "sheep", " ", "are", " ", "alone"}]}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Append", "[", 
       RowBox[{"clusterCores", ",", 
        RowBox[{"Lookup", "[", 
         RowBox[{"clusterNoncores", ",", 
          RowBox[{"Key", "[", 
           RowBox[{"{", "}"}], "]"}], ",", 
          RowBox[{"{", "}"}]}], "]"}]}], "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}]}]], "Input",
 CellChangeTimes->{
  3.8210562928338013`*^9, {3.821056328097218*^9, 3.821056405941293*^9}, {
   3.821056570978305*^9, 3.821056598649345*^9}, {3.821056711330344*^9, 
   3.821056799479229*^9}, {3.821057210783979*^9, 3.821057510282115*^9}, {
   3.8210575554663754`*^9, 3.82105755615449*^9}},
 CellLabel->"In[12]:=",ExpressionUUID->"353d35e9-cc91-43df-9dab-415c9f8792a7"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Test on one time snapshot", "Section",
 CellChangeTimes->{{3.821096443547168*^9, 
  3.821096453730466*^9}},ExpressionUUID->"0a93a041-3341-4b89-852d-\
4dd23383b76a"],

Cell["Pick a time step:", "Text",
 CellChangeTimes->{{3.821096457426156*^9, 
  3.821096472794365*^9}},ExpressionUUID->"06eecf62-e140-4a89-8d39-\
397256d522d5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"pts", "=", 
   RowBox[{"rawCoordinates", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "10000"}], "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8210964773550777`*^9, 3.821096493950161*^9}, {
  3.821096704947596*^9, 3.8210967161546993`*^9}},
 CellLabel->"In[19]:=",ExpressionUUID->"82386423-4a0a-49d5-83f0-314785cdf620"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Association", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"#", "\[Rule]", 
     RowBox[{"{", "}"}]}], "&"}], "/@", 
   RowBox[{"Range", "[", 
    RowBox[{"Length", "[", "pts", "]"}], "]"}]}], "]"}]], "Input",
 CellLabel->"In[17]:=",ExpressionUUID->"0c254f18-c467-4bbd-a471-6ec230d14da6"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"1", "\[Rule]", 
    RowBox[{"{", "}"}]}], ",", 
   RowBox[{"2", "\[Rule]", 
    RowBox[{"{", "}"}]}], ",", 
   RowBox[{"3", "\[Rule]", 
    RowBox[{"{", "}"}]}], ",", 
   RowBox[{"4", "\[Rule]", 
    RowBox[{"{", "}"}]}], ",", 
   RowBox[{"5", "\[Rule]", 
    RowBox[{"{", "}"}]}], ",", 
   RowBox[{"6", "\[Rule]", 
    RowBox[{"{", "}"}]}], ",", 
   RowBox[{"7", "\[Rule]", 
    RowBox[{"{", "}"}]}], ",", 
   RowBox[{"8", "\[Rule]", 
    RowBox[{"{", "}"}]}], ",", 
   RowBox[{"9", "\[Rule]", 
    RowBox[{"{", "}"}]}], ",", 
   RowBox[{"10", "\[Rule]", 
    RowBox[{"{", "}"}]}], ",", 
   RowBox[{"11", "\[Rule]", 
    RowBox[{"{", "}"}]}], ",", 
   RowBox[{"12", "\[Rule]", 
    RowBox[{"{", "}"}]}], ",", 
   RowBox[{"13", "\[Rule]", 
    RowBox[{"{", "}"}]}], ",", 
   RowBox[{"14", "\[Rule]", 
    RowBox[{"{", "}"}]}], ",", 
   RowBox[{"15", "\[Rule]", 
    RowBox[{"{", "}"}]}], ",", 
   RowBox[{"16", "\[Rule]", 
    RowBox[{"{", "}"}]}], ",", 
   RowBox[{"17", "\[Rule]", 
    RowBox[{"{", "}"}]}], ",", 
   RowBox[{"18", "\[Rule]", 
    RowBox[{"{", "}"}]}], ",", 
   RowBox[{"19", "\[Rule]", 
    RowBox[{"{", "}"}]}], ",", 
   RowBox[{"20", "\[Rule]", 
    RowBox[{"{", "}"}]}], ",", 
   RowBox[{"21", "\[Rule]", 
    RowBox[{"{", "}"}]}], ",", 
   RowBox[{"22", "\[Rule]", 
    RowBox[{"{", "}"}]}], ",", 
   RowBox[{"23", "\[Rule]", 
    RowBox[{"{", "}"}]}], ",", 
   RowBox[{"24", "\[Rule]", 
    RowBox[{"{", "}"}]}], ",", 
   RowBox[{"25", "\[Rule]", 
    RowBox[{"{", "}"}]}], ",", 
   RowBox[{"26", "\[Rule]", 
    RowBox[{"{", "}"}]}], ",", 
   RowBox[{"27", "\[Rule]", 
    RowBox[{"{", "}"}]}], ",", 
   RowBox[{"28", "\[Rule]", 
    RowBox[{"{", "}"}]}], ",", 
   RowBox[{"29", "\[Rule]", 
    RowBox[{"{", "}"}]}], ",", 
   RowBox[{"30", "\[Rule]", 
    RowBox[{"{", "}"}]}], ",", 
   RowBox[{"31", "\[Rule]", 
    RowBox[{"{", "}"}]}], ",", 
   RowBox[{"32", "\[Rule]", 
    RowBox[{"{", "}"}]}], ",", 
   RowBox[{"33", "\[Rule]", 
    RowBox[{"{", "}"}]}], ",", 
   RowBox[{"34", "\[Rule]", 
    RowBox[{"{", "}"}]}], ",", 
   RowBox[{"35", "\[Rule]", 
    RowBox[{"{", "}"}]}], ",", 
   RowBox[{"36", "\[Rule]", 
    RowBox[{"{", "}"}]}], ",", 
   RowBox[{"37", "\[Rule]", 
    RowBox[{"{", "}"}]}], ",", 
   RowBox[{"38", "\[Rule]", 
    RowBox[{"{", "}"}]}], ",", 
   RowBox[{"39", "\[Rule]", 
    RowBox[{"{", "}"}]}], ",", 
   RowBox[{"40", "\[Rule]", 
    RowBox[{"{", "}"}]}], ",", 
   RowBox[{"41", "\[Rule]", 
    RowBox[{"{", "}"}]}], ",", 
   RowBox[{"42", "\[Rule]", 
    RowBox[{"{", "}"}]}], ",", 
   RowBox[{"43", "\[Rule]", 
    RowBox[{"{", "}"}]}], ",", 
   RowBox[{"44", "\[Rule]", 
    RowBox[{"{", "}"}]}], ",", 
   RowBox[{"45", "\[Rule]", 
    RowBox[{"{", "}"}]}], ",", 
   RowBox[{"46", "\[Rule]", 
    RowBox[{"{", "}"}]}], ",", 
   RowBox[{"47", "\[Rule]", 
    RowBox[{"{", "}"}]}], ",", 
   RowBox[{"48", "\[Rule]", 
    RowBox[{"{", "}"}]}], ",", 
   RowBox[{"49", "\[Rule]", 
    RowBox[{"{", "}"}]}], ",", 
   RowBox[{"50", "\[Rule]", 
    RowBox[{"{", "}"}]}], ",", 
   RowBox[{"51", "\[Rule]", 
    RowBox[{"{", "}"}]}]}], "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{3.821096663875744*^9},
 CellLabel->"Out[17]=",ExpressionUUID->"f254ee4b-7f3d-4502-afa6-e0e8446d1450"]
}, Open  ]],

Cell["\<\
Run, assuming no prior information on clusters, with r1=10, r2=15, k = 3,\
\>", "Text",
 CellChangeTimes->{{3.821096498793829*^9, 
  3.821096581849267*^9}},ExpressionUUID->"21ec29fa-a08d-488e-95f2-\
3e7ef0d0fda3"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"testClustering", " ", "=", " ", 
  RowBox[{"dbscanSticky", "[", 
   RowBox[{"pts", ",", 
    RowBox[{"{", 
     RowBox[{"10", ",", "15"}], "}"}], ",", "3", ",", " ", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"#", "\[Rule]", 
        RowBox[{"{", "}"}]}], "&"}], "/@", 
      RowBox[{"Range", "[", 
       RowBox[{"Length", "[", "pts", "]"}], "]"}]}], "]"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.82109651543718*^9, 3.821096534524548*^9}, {
  3.821096569057609*^9, 3.821096616161088*^9}, {3.821096855150982*^9, 
  3.821096859424358*^9}},
 CellLabel->"In[24]:=",ExpressionUUID->"5c815cfd-ff3f-43a5-a938-d28f19528932"],

Cell[BoxData[
 TemplateBox[{
  "NearestFunction", "near3", 
   "\"\\!\\(\\*RowBox[{\\\"{\\\", RowBox[{\\\"All\\\", \\\",\\\", \
\\\"r\\\"}], \\\"}\\\"}]\\) is neither a non-negative integer nor a list of \
the form {n, r} with n a positive integer and r a non-negative real \
number.\"", 2, 24, 67, 26978987633308464836, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.821096624986668*^9, 3.821096718349229*^9, {3.8210968560471153`*^9, 
   3.821096860150906*^9}},
 CellLabel->
  "During evaluation of \
In[24]:=",ExpressionUUID->"68b57172-cba8-4c34-998f-6f17de49f488"],

Cell[BoxData[
 TemplateBox[{
  "NearestFunction", "near3", 
   "\"\\!\\(\\*RowBox[{\\\"{\\\", \\\"r\\\", \\\"}\\\"}]\\) is neither a \
non-negative integer nor a list of the form {n, r} with n a positive integer \
and r a non-negative real number.\"", 2, 24, 68, 26978987633308464836, 
   "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.821096624986668*^9, 3.821096718349229*^9, {3.8210968560471153`*^9, 
   3.8210968601592617`*^9}},
 CellLabel->
  "During evaluation of \
In[24]:=",ExpressionUUID->"cbac8e88-7337-438e-8eac-a9d3a33cac9c"],

Cell[BoxData[
 TemplateBox[{
  "MapThread", "mptd", 
   "\"Object \\!\\(\\*RowBox[{RowBox[{\\\"NearestFunction\\\", \\\"[\\\", \
RowBox[{\\\"Hold\\\", \\\"[\\\", RowBox[{\\\"Nearest\\\", \\\"[\\\", RowBox[{\
\\\"\[LeftAssociation]\\\", RowBox[{RowBox[{\\\"1\\\", \\\"\[Rule]\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"582169.683534927`\\\", \\\",\\\", \
\\\"6.56364145974907`*^6\\\"}], \\\"}\\\"}]}], \\\",\\\", RowBox[{\\\"2\\\", \
\\\"\[Rule]\\\", RowBox[{\\\"{\\\", RowBox[{\\\"583787.828988686`\\\", \
\\\",\\\", \\\"6.56361661308255`*^6\\\"}], \\\"}\\\"}]}], \\\",\\\", RowBox[{\
\\\"3\\\", \\\"\[Rule]\\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"582200.437801118`\\\", \\\",\\\", \\\"6.56369034120651`*^6\\\"}], \
\\\"}\\\"}]}], \\\",\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"44\\\", \\\"\
\[RightSkeleton]\\\"}], \\\",\\\", RowBox[{\\\"48\\\", \\\"\[Rule]\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"580685.338425181`\\\", \\\",\\\", \
\\\"6.56356057973464`*^6\\\"}], \\\"}\\\"}]}], \\\",\\\", RowBox[{\\\"49\\\", \
\\\"\[Rule]\\\", RowBox[{\\\"{\\\", RowBox[{\\\"580684.798941444`\\\", \
\\\",\\\", \\\"6.56356491603506`*^6\\\"}], \\\"}\\\"}]}], \\\",\\\", RowBox[{\
\\\"51\\\", \\\"\[Rule]\\\", RowBox[{\\\"{\\\", RowBox[{\\\"580684.740462218`\
\\\", \\\",\\\", \\\"6.56355723697336`*^6\\\"}], \\\"}\\\"}]}]}], \\\"\
\[RightAssociation]\\\"}], \\\"]\\\"}], \\\"]\\\"}], \\\"]\\\"}], \\\"[\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"17\\\", \\\"\[RightSkeleton]\\\"}], \\\",\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"20\\\", \\\"\[RightSkeleton]\\\"}]}], \\\
\"}\\\"}], \\\",\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"47\\\", \\\"\
\[RightSkeleton]\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"1\\\", \\\"\[RightSkeleton]\\\"}], \\\"}\\\"}]}], \\\
\"}\\\"}], \\\",\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \\\"\
\[RightSkeleton]\\\"}]}], \\\"]\\\"}]\\) at position {2, \
\\!\\(\\*RowBox[{\\\"1\\\"}]\\)} in \\!\\(\\*RowBox[{\\\"MapThread\\\", \\\"[\
\\\", RowBox[{RowBox[{RowBox[{\\\"#2\\\", \\\"\[Rule]\\\", RowBox[{\\\"With\\\
\", \\\"[\\\", RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"prevNeighbors$\\\", \
\\\"=\\\", RowBox[{RowBox[{\\\"\[LeftAssociation]\\\", \
RowBox[{RowBox[{\\\"1\\\", \\\"\[Rule]\\\", RowBox[{\\\"{\\\", \\\"}\\\"}]}], \
\\\",\\\", RowBox[{\\\"2\\\", \\\"\[Rule]\\\", RowBox[{\\\"{\\\", \
\\\"}\\\"}]}], \\\",\\\", RowBox[{\\\"3\\\", \\\"\[Rule]\\\", RowBox[{\\\"{\\\
\", \\\"}\\\"}]}], \\\",\\\", RowBox[{\\\"4\\\", \\\"\[Rule]\\\", \
RowBox[{\\\"{\\\", \\\"}\\\"}]}], \\\",\\\", RowBox[{\\\"5\\\", \\\"\[Rule]\\\
\", RowBox[{\\\"{\\\", \\\"}\\\"}]}], \\\",\\\", RowBox[{\\\"6\\\", \\\"\
\[Rule]\\\", RowBox[{\\\"{\\\", \\\"}\\\"}]}], \\\",\\\", RowBox[{\\\"7\\\", \
\\\"\[Rule]\\\", RowBox[{\\\"{\\\", \\\"}\\\"}]}], \\\",\\\", RowBox[{\\\"8\\\
\", \\\"\[Rule]\\\", RowBox[{\\\"{\\\", \\\"}\\\"}]}], \\\",\\\", \
RowBox[{\\\"9\\\", \\\"\[Rule]\\\", RowBox[{\\\"{\\\", \\\"}\\\"}]}], \\\",\\\
\", RowBox[{\\\"10\\\", \\\"\[Rule]\\\", RowBox[{\\\"{\\\", \\\"}\\\"}]}], \\\
\",\\\", RowBox[{\\\"11\\\", \\\"\[Rule]\\\", RowBox[{\\\"{\\\", \
\\\"}\\\"}]}], \\\",\\\", RowBox[{\\\"12\\\", \\\"\[Rule]\\\", \
RowBox[{\\\"{\\\", \\\"}\\\"}]}], \\\",\\\", RowBox[{\\\"13\\\", \
\\\"\[Rule]\\\", RowBox[{\\\"{\\\", \\\"}\\\"}]}], \\\",\\\", \
RowBox[{\\\"14\\\", \\\"\[Rule]\\\", RowBox[{\\\"{\\\", \\\"}\\\"}]}], \
\\\",\\\", RowBox[{\\\"15\\\", \\\"\[Rule]\\\", RowBox[{\\\"{\\\", \
\\\"}\\\"}]}], \\\",\\\", RowBox[{\\\"16\\\", \\\"\[Rule]\\\", \
RowBox[{\\\"{\\\", \\\"}\\\"}]}], \\\",\\\", RowBox[{\\\"17\\\", \
\\\"\[Rule]\\\", RowBox[{\\\"{\\\", \\\"}\\\"}]}], \\\",\\\", \
RowBox[{\\\"18\\\", \\\"\[Rule]\\\", RowBox[{\\\"{\\\", \\\"}\\\"}]}], \
\\\",\\\", RowBox[{\\\"19\\\", \\\"\[Rule]\\\", RowBox[{\\\"{\\\", \
\\\"}\\\"}]}], \\\",\\\", RowBox[{\\\"20\\\", \\\"\[Rule]\\\", \
RowBox[{\\\"{\\\", \\\"}\\\"}]}], \\\",\\\", RowBox[{\\\"21\\\", \
\\\"\[Rule]\\\", RowBox[{\\\"{\\\", \\\"}\\\"}]}], \\\",\\\", \
RowBox[{\\\"22\\\", \\\"\[Rule]\\\", RowBox[{\\\"{\\\", \\\"}\\\"}]}], \
\\\",\\\", RowBox[{\\\"23\\\", \\\"\[Rule]\\\", RowBox[{\\\"{\\\", \
\\\"}\\\"}]}], \\\",\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"5\\\", \\\"\
\[RightSkeleton]\\\"}], \\\",\\\", RowBox[{\\\"29\\\", \\\"\[Rule]\\\", \
RowBox[{\\\"{\\\", \\\"}\\\"}]}], \\\",\\\", RowBox[{\\\"30\\\", \
\\\"\[Rule]\\\", RowBox[{\\\"{\\\", \\\"}\\\"}]}], \\\",\\\", \
RowBox[{\\\"31\\\", \\\"\[Rule]\\\", RowBox[{\\\"{\\\", \\\"}\\\"}]}], \
\\\",\\\", RowBox[{\\\"32\\\", \\\"\[Rule]\\\", RowBox[{\\\"{\\\", \
\\\"}\\\"}]}], \\\",\\\", RowBox[{\\\"33\\\", \\\"\[Rule]\\\", \
RowBox[{\\\"{\\\", \\\"}\\\"}]}], \\\",\\\", RowBox[{\\\"34\\\", \
\\\"\[Rule]\\\", RowBox[{\\\"{\\\", \\\"}\\\"}]}], \\\",\\\", \
RowBox[{\\\"35\\\", \\\"\[Rule]\\\", RowBox[{\\\"{\\\", \\\"}\\\"}]}], \
\\\",\\\", RowBox[{\\\"36\\\", \\\"\[Rule]\\\", RowBox[{\\\"{\\\", \
\\\"}\\\"}]}], \\\",\\\", RowBox[{\\\"37\\\", \\\"\[Rule]\\\", \
RowBox[{\\\"{\\\", \\\"}\\\"}]}], \\\",\\\", RowBox[{\\\"38\\\", \
\\\"\[Rule]\\\", RowBox[{\\\"{\\\", \\\"}\\\"}]}], \\\",\\\", \
RowBox[{\\\"39\\\", \\\"\[Rule]\\\", RowBox[{\\\"{\\\", \\\"}\\\"}]}], \
\\\",\\\", RowBox[{\\\"40\\\", \\\"\[Rule]\\\", RowBox[{\\\"{\\\", \
\\\"}\\\"}]}], \\\",\\\", RowBox[{\\\"41\\\", \\\"\[Rule]\\\", \
RowBox[{\\\"{\\\", \\\"}\\\"}]}], \\\",\\\", RowBox[{\\\"42\\\", \
\\\"\[Rule]\\\", RowBox[{\\\"{\\\", \\\"}\\\"}]}], \\\",\\\", \
RowBox[{\\\"43\\\", \\\"\[Rule]\\\", RowBox[{\\\"{\\\", \\\"}\\\"}]}], \
\\\",\\\", RowBox[{\\\"44\\\", \\\"\[Rule]\\\", RowBox[{\\\"{\\\", \
\\\"}\\\"}]}], \\\",\\\", RowBox[{\\\"45\\\", \\\"\[Rule]\\\", \
RowBox[{\\\"{\\\", \\\"}\\\"}]}], \\\",\\\", RowBox[{\\\"46\\\", \
\\\"\[Rule]\\\", RowBox[{\\\"{\\\", \\\"}\\\"}]}], \\\",\\\", \
RowBox[{\\\"47\\\", \\\"\[Rule]\\\", RowBox[{\\\"{\\\", \\\"}\\\"}]}], \
\\\",\\\", RowBox[{\\\"48\\\", \\\"\[Rule]\\\", RowBox[{\\\"{\\\", \
\\\"}\\\"}]}], \\\",\\\", RowBox[{\\\"49\\\", \\\"\[Rule]\\\", \
RowBox[{\\\"{\\\", \\\"}\\\"}]}], \\\",\\\", RowBox[{\\\"50\\\", \
\\\"\[Rule]\\\", RowBox[{\\\"{\\\", \\\"}\\\"}]}], \\\",\\\", \
RowBox[{\\\"51\\\", \\\"\[Rule]\\\", RowBox[{\\\"{\\\", \\\"}\\\"}]}]}], \\\"\
\[RightAssociation]\\\"}], \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"1\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \\\"\[RightSkeleton]\\\"}]}], \
\\\"]\\\"}]}], \\\"&\\\"}], \\\",\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\
\\\", \\\"\[RightSkeleton]\\\"}]}], \\\"]\\\"}]\\) has only \\!\\(\\*RowBox[{\
\\\"0\\\"}]\\) of required \\!\\(\\*RowBox[{\\\"1\\\"}]\\) dimensions.\"", 2, 
   24, 69, 26978987633308464836, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.821096624986668*^9, 3.821096718349229*^9, {3.8210968560471153`*^9, 
   3.821096860165477*^9}},
 CellLabel->
  "During evaluation of \
In[24]:=",ExpressionUUID->"064b7ab0-95f8-4486-99c1-96be5f8cda6b"],

Cell[BoxData[
 TemplateBox[{
  "NearestFunction", "near3", 
   "\"\\!\\(\\*RowBox[{\\\"{\\\", RowBox[{\\\"All\\\", \\\",\\\", \
\\\"r\\\"}], \\\"}\\\"}]\\) is neither a non-negative integer nor a list of \
the form {n, r} with n a positive integer and r a non-negative real \
number.\"", 2, 24, 70, 26978987633308464836, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.821096624986668*^9, 3.821096718349229*^9, {3.8210968560471153`*^9, 
   3.821096860176017*^9}},
 CellLabel->
  "During evaluation of \
In[24]:=",ExpressionUUID->"9aeebc73-5044-4c12-bf44-9c0e06d6d93d"],

Cell[BoxData[
 TemplateBox[{
  "General", "stop", 
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"NearestFunction\\\", \\\
\"::\\\", \\\"near3\\\"}], \\\"MessageName\\\"]\\) will be suppressed during \
this calculation.\"", 2, 24, 71, 26978987633308464836, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.821096624986668*^9, 3.821096718349229*^9, {3.8210968560471153`*^9, 
   3.821096860182455*^9}},
 CellLabel->
  "During evaluation of \
In[24]:=",ExpressionUUID->"2321c92f-87a3-443f-aeef-536ded1c7684"],

Cell[BoxData[
 TemplateBox[{
  "MapThread", "mptd", 
   "\"Object \\!\\(\\*RowBox[{RowBox[{\\\"NearestFunction\\\", \\\"[\\\", \
RowBox[{\\\"Hold\\\", \\\"[\\\", RowBox[{\\\"Nearest\\\", \\\"[\\\", RowBox[{\
\\\"\[LeftAssociation]\\\", RowBox[{RowBox[{\\\"1\\\", \\\"\[Rule]\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"582169.683534927`\\\", \\\",\\\", \
\\\"6.56364145974907`*^6\\\"}], \\\"}\\\"}]}], \\\",\\\", RowBox[{\\\"2\\\", \
\\\"\[Rule]\\\", RowBox[{\\\"{\\\", RowBox[{\\\"583787.828988686`\\\", \
\\\",\\\", \\\"6.56361661308255`*^6\\\"}], \\\"}\\\"}]}], \\\",\\\", RowBox[{\
\\\"3\\\", \\\"\[Rule]\\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"582200.437801118`\\\", \\\",\\\", \\\"6.56369034120651`*^6\\\"}], \
\\\"}\\\"}]}], \\\",\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"44\\\", \\\"\
\[RightSkeleton]\\\"}], \\\",\\\", RowBox[{\\\"48\\\", \\\"\[Rule]\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"580685.338425181`\\\", \\\",\\\", \
\\\"6.56356057973464`*^6\\\"}], \\\"}\\\"}]}], \\\",\\\", RowBox[{\\\"49\\\", \
\\\"\[Rule]\\\", RowBox[{\\\"{\\\", RowBox[{\\\"580684.798941444`\\\", \
\\\",\\\", \\\"6.56356491603506`*^6\\\"}], \\\"}\\\"}]}], \\\",\\\", RowBox[{\
\\\"51\\\", \\\"\[Rule]\\\", RowBox[{\\\"{\\\", RowBox[{\\\"580684.740462218`\
\\\", \\\",\\\", \\\"6.56355723697336`*^6\\\"}], \\\"}\\\"}]}]}], \\\"\
\[RightAssociation]\\\"}], \\\"]\\\"}], \\\"]\\\"}], \\\"]\\\"}], \\\"[\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"17\\\", \\\"\[RightSkeleton]\\\"}], \\\",\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"20\\\", \\\"\[RightSkeleton]\\\"}]}], \\\
\"}\\\"}], \\\",\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"47\\\", \\\"\
\[RightSkeleton]\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"1\\\", \\\"\[RightSkeleton]\\\"}], \\\"}\\\"}]}], \\\
\"}\\\"}], \\\",\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \\\"\
\[RightSkeleton]\\\"}]}], \\\"]\\\"}]\\) at position {2, \
\\!\\(\\*RowBox[{\\\"1\\\"}]\\)} in \\!\\(\\*RowBox[{\\\"MapThread\\\", \\\"[\
\\\", RowBox[{RowBox[{RowBox[{\\\"#2\\\", \\\"\[Rule]\\\", RowBox[{\\\"With\\\
\", \\\"[\\\", RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"prevNeighbors$\\\", \
\\\"=\\\", RowBox[{RowBox[{\\\"\[LeftAssociation]\\\", \
RowBox[{RowBox[{\\\"1\\\", \\\"\[Rule]\\\", RowBox[{\\\"{\\\", \\\"}\\\"}]}], \
\\\",\\\", RowBox[{\\\"2\\\", \\\"\[Rule]\\\", RowBox[{\\\"{\\\", \
\\\"}\\\"}]}], \\\",\\\", RowBox[{\\\"3\\\", \\\"\[Rule]\\\", RowBox[{\\\"{\\\
\", \\\"}\\\"}]}], \\\",\\\", RowBox[{\\\"4\\\", \\\"\[Rule]\\\", \
RowBox[{\\\"{\\\", \\\"}\\\"}]}], \\\",\\\", RowBox[{\\\"5\\\", \\\"\[Rule]\\\
\", RowBox[{\\\"{\\\", \\\"}\\\"}]}], \\\",\\\", RowBox[{\\\"6\\\", \\\"\
\[Rule]\\\", RowBox[{\\\"{\\\", \\\"}\\\"}]}], \\\",\\\", RowBox[{\\\"7\\\", \
\\\"\[Rule]\\\", RowBox[{\\\"{\\\", \\\"}\\\"}]}], \\\",\\\", RowBox[{\\\"8\\\
\", \\\"\[Rule]\\\", RowBox[{\\\"{\\\", \\\"}\\\"}]}], \\\",\\\", \
RowBox[{\\\"9\\\", \\\"\[Rule]\\\", RowBox[{\\\"{\\\", \\\"}\\\"}]}], \\\",\\\
\", RowBox[{\\\"10\\\", \\\"\[Rule]\\\", RowBox[{\\\"{\\\", \\\"}\\\"}]}], \\\
\",\\\", RowBox[{\\\"11\\\", \\\"\[Rule]\\\", RowBox[{\\\"{\\\", \
\\\"}\\\"}]}], \\\",\\\", RowBox[{\\\"12\\\", \\\"\[Rule]\\\", \
RowBox[{\\\"{\\\", \\\"}\\\"}]}], \\\",\\\", RowBox[{\\\"13\\\", \
\\\"\[Rule]\\\", RowBox[{\\\"{\\\", \\\"}\\\"}]}], \\\",\\\", \
RowBox[{\\\"14\\\", \\\"\[Rule]\\\", RowBox[{\\\"{\\\", \\\"}\\\"}]}], \
\\\",\\\", RowBox[{\\\"15\\\", \\\"\[Rule]\\\", RowBox[{\\\"{\\\", \
\\\"}\\\"}]}], \\\",\\\", RowBox[{\\\"16\\\", \\\"\[Rule]\\\", \
RowBox[{\\\"{\\\", \\\"}\\\"}]}], \\\",\\\", RowBox[{\\\"17\\\", \
\\\"\[Rule]\\\", RowBox[{\\\"{\\\", \\\"}\\\"}]}], \\\",\\\", \
RowBox[{\\\"18\\\", \\\"\[Rule]\\\", RowBox[{\\\"{\\\", \\\"}\\\"}]}], \
\\\",\\\", RowBox[{\\\"19\\\", \\\"\[Rule]\\\", RowBox[{\\\"{\\\", \
\\\"}\\\"}]}], \\\",\\\", RowBox[{\\\"20\\\", \\\"\[Rule]\\\", \
RowBox[{\\\"{\\\", \\\"}\\\"}]}], \\\",\\\", RowBox[{\\\"21\\\", \
\\\"\[Rule]\\\", RowBox[{\\\"{\\\", \\\"}\\\"}]}], \\\",\\\", \
RowBox[{\\\"22\\\", \\\"\[Rule]\\\", RowBox[{\\\"{\\\", \\\"}\\\"}]}], \
\\\",\\\", RowBox[{\\\"23\\\", \\\"\[Rule]\\\", RowBox[{\\\"{\\\", \
\\\"}\\\"}]}], \\\",\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"5\\\", \\\"\
\[RightSkeleton]\\\"}], \\\",\\\", RowBox[{\\\"29\\\", \\\"\[Rule]\\\", \
RowBox[{\\\"{\\\", \\\"}\\\"}]}], \\\",\\\", RowBox[{\\\"30\\\", \
\\\"\[Rule]\\\", RowBox[{\\\"{\\\", \\\"}\\\"}]}], \\\",\\\", \
RowBox[{\\\"31\\\", \\\"\[Rule]\\\", RowBox[{\\\"{\\\", \\\"}\\\"}]}], \
\\\",\\\", RowBox[{\\\"32\\\", \\\"\[Rule]\\\", RowBox[{\\\"{\\\", \
\\\"}\\\"}]}], \\\",\\\", RowBox[{\\\"33\\\", \\\"\[Rule]\\\", \
RowBox[{\\\"{\\\", \\\"}\\\"}]}], \\\",\\\", RowBox[{\\\"34\\\", \
\\\"\[Rule]\\\", RowBox[{\\\"{\\\", \\\"}\\\"}]}], \\\",\\\", \
RowBox[{\\\"35\\\", \\\"\[Rule]\\\", RowBox[{\\\"{\\\", \\\"}\\\"}]}], \
\\\",\\\", RowBox[{\\\"36\\\", \\\"\[Rule]\\\", RowBox[{\\\"{\\\", \
\\\"}\\\"}]}], \\\",\\\", RowBox[{\\\"37\\\", \\\"\[Rule]\\\", \
RowBox[{\\\"{\\\", \\\"}\\\"}]}], \\\",\\\", RowBox[{\\\"38\\\", \
\\\"\[Rule]\\\", RowBox[{\\\"{\\\", \\\"}\\\"}]}], \\\",\\\", \
RowBox[{\\\"39\\\", \\\"\[Rule]\\\", RowBox[{\\\"{\\\", \\\"}\\\"}]}], \
\\\",\\\", RowBox[{\\\"40\\\", \\\"\[Rule]\\\", RowBox[{\\\"{\\\", \
\\\"}\\\"}]}], \\\",\\\", RowBox[{\\\"41\\\", \\\"\[Rule]\\\", \
RowBox[{\\\"{\\\", \\\"}\\\"}]}], \\\",\\\", RowBox[{\\\"42\\\", \
\\\"\[Rule]\\\", RowBox[{\\\"{\\\", \\\"}\\\"}]}], \\\",\\\", \
RowBox[{\\\"43\\\", \\\"\[Rule]\\\", RowBox[{\\\"{\\\", \\\"}\\\"}]}], \
\\\",\\\", RowBox[{\\\"44\\\", \\\"\[Rule]\\\", RowBox[{\\\"{\\\", \
\\\"}\\\"}]}], \\\",\\\", RowBox[{\\\"45\\\", \\\"\[Rule]\\\", \
RowBox[{\\\"{\\\", \\\"}\\\"}]}], \\\",\\\", RowBox[{\\\"46\\\", \
\\\"\[Rule]\\\", RowBox[{\\\"{\\\", \\\"}\\\"}]}], \\\",\\\", \
RowBox[{\\\"47\\\", \\\"\[Rule]\\\", RowBox[{\\\"{\\\", \\\"}\\\"}]}], \
\\\",\\\", RowBox[{\\\"48\\\", \\\"\[Rule]\\\", RowBox[{\\\"{\\\", \
\\\"}\\\"}]}], \\\",\\\", RowBox[{\\\"49\\\", \\\"\[Rule]\\\", \
RowBox[{\\\"{\\\", \\\"}\\\"}]}], \\\",\\\", RowBox[{\\\"50\\\", \
\\\"\[Rule]\\\", RowBox[{\\\"{\\\", \\\"}\\\"}]}], \\\",\\\", \
RowBox[{\\\"51\\\", \\\"\[Rule]\\\", RowBox[{\\\"{\\\", \\\"}\\\"}]}]}], \\\"\
\[RightAssociation]\\\"}], \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"1\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \\\"\[RightSkeleton]\\\"}]}], \
\\\"]\\\"}]}], \\\"&\\\"}], \\\",\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\
\\\", \\\"\[RightSkeleton]\\\"}]}], \\\"]\\\"}]\\) has only \\!\\(\\*RowBox[{\
\\\"0\\\"}]\\) of required \\!\\(\\*RowBox[{\\\"1\\\"}]\\) dimensions.\"", 2, 
   24, 72, 26978987633308464836, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.821096624986668*^9, 3.821096718349229*^9, {3.8210968560471153`*^9, 
   3.821096860188716*^9}},
 CellLabel->
  "During evaluation of \
In[24]:=",ExpressionUUID->"30f68c28-25ba-4c48-b455-48a23d51a5a5"],

Cell[BoxData[
 TemplateBox[{
  "Part", "partd1", 
   "\"Depth of object \\!\\(\\*RowBox[{\\\"{\\\", \\\"1\\\", \\\"}\\\"}]\\) \
is not sufficient for the given part specification.\"", 2, 24, 73, 
   26978987633308464836, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.821096624986668*^9, 3.821096718349229*^9, {3.8210968560471153`*^9, 
   3.82109686019977*^9}},
 CellLabel->
  "During evaluation of \
In[24]:=",ExpressionUUID->"428a7f88-b785-469e-b285-efba877d2123"],

Cell[BoxData[
 TemplateBox[{
  "Lookup", "invrl", 
   "\"The argument \\!\\(\\*RowBox[{\\\"Association\\\", \\\"[\\\", \
RowBox[{\\\"MapThread\\\", \\\"[\\\", RowBox[{RowBox[{RowBox[{\\\"#2\\\", \
\\\"\[Rule]\\\", RowBox[{\\\"With\\\", \\\"[\\\", RowBox[{RowBox[{\\\"{\\\", \
RowBox[{\\\"prevNeighbors$\\\", \\\"=\\\", RowBox[{RowBox[{\\\"\
\[LeftAssociation]\\\", RowBox[{RowBox[{\\\"1\\\", \\\"\[Rule]\\\", \
RowBox[{\\\"{\\\", \\\"}\\\"}]}], \\\",\\\", RowBox[{\\\"2\\\", \\\"\[Rule]\\\
\", RowBox[{\\\"{\\\", \\\"}\\\"}]}], \\\",\\\", RowBox[{\\\"3\\\", \\\"\
\[Rule]\\\", RowBox[{\\\"{\\\", \\\"}\\\"}]}], \\\",\\\", RowBox[{\\\"4\\\", \
\\\"\[Rule]\\\", RowBox[{\\\"{\\\", \\\"}\\\"}]}], \\\",\\\", RowBox[{\\\"5\\\
\", \\\"\[Rule]\\\", RowBox[{\\\"{\\\", \\\"}\\\"}]}], \\\",\\\", \
RowBox[{\\\"6\\\", \\\"\[Rule]\\\", RowBox[{\\\"{\\\", \\\"}\\\"}]}], \\\",\\\
\", RowBox[{\\\"7\\\", \\\"\[Rule]\\\", RowBox[{\\\"{\\\", \\\"}\\\"}]}], \
\\\",\\\", RowBox[{\\\"8\\\", \\\"\[Rule]\\\", RowBox[{\\\"{\\\", \
\\\"}\\\"}]}], \\\",\\\", RowBox[{\\\"9\\\", \\\"\[Rule]\\\", RowBox[{\\\"{\\\
\", \\\"}\\\"}]}], \\\",\\\", RowBox[{\\\"10\\\", \\\"\[Rule]\\\", RowBox[{\\\
\"{\\\", \\\"}\\\"}]}], \\\",\\\", RowBox[{\\\"11\\\", \\\"\[Rule]\\\", \
RowBox[{\\\"{\\\", \\\"}\\\"}]}], \\\",\\\", RowBox[{\\\"12\\\", \
\\\"\[Rule]\\\", RowBox[{\\\"{\\\", \\\"}\\\"}]}], \\\",\\\", \
RowBox[{\\\"13\\\", \\\"\[Rule]\\\", RowBox[{\\\"{\\\", \\\"}\\\"}]}], \
\\\",\\\", RowBox[{\\\"14\\\", \\\"\[Rule]\\\", RowBox[{\\\"{\\\", \
\\\"}\\\"}]}], \\\",\\\", RowBox[{\\\"15\\\", \\\"\[Rule]\\\", \
RowBox[{\\\"{\\\", \\\"}\\\"}]}], \\\",\\\", RowBox[{\\\"16\\\", \
\\\"\[Rule]\\\", RowBox[{\\\"{\\\", \\\"}\\\"}]}], \\\",\\\", \
RowBox[{\\\"17\\\", \\\"\[Rule]\\\", RowBox[{\\\"{\\\", \\\"}\\\"}]}], \
\\\",\\\", RowBox[{\\\"18\\\", \\\"\[Rule]\\\", RowBox[{\\\"{\\\", \
\\\"}\\\"}]}], \\\",\\\", RowBox[{\\\"19\\\", \\\"\[Rule]\\\", \
RowBox[{\\\"{\\\", \\\"}\\\"}]}], \\\",\\\", RowBox[{\\\"20\\\", \
\\\"\[Rule]\\\", RowBox[{\\\"{\\\", \\\"}\\\"}]}], \\\",\\\", \
RowBox[{\\\"21\\\", \\\"\[Rule]\\\", RowBox[{\\\"{\\\", \\\"}\\\"}]}], \
\\\",\\\", RowBox[{\\\"22\\\", \\\"\[Rule]\\\", RowBox[{\\\"{\\\", \
\\\"}\\\"}]}], \\\",\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"7\\\", \\\"\
\[RightSkeleton]\\\"}], \\\",\\\", RowBox[{\\\"30\\\", \\\"\[Rule]\\\", \
RowBox[{\\\"{\\\", \\\"}\\\"}]}], \\\",\\\", RowBox[{\\\"31\\\", \
\\\"\[Rule]\\\", RowBox[{\\\"{\\\", \\\"}\\\"}]}], \\\",\\\", \
RowBox[{\\\"32\\\", \\\"\[Rule]\\\", RowBox[{\\\"{\\\", \\\"}\\\"}]}], \
\\\",\\\", RowBox[{\\\"33\\\", \\\"\[Rule]\\\", RowBox[{\\\"{\\\", \
\\\"}\\\"}]}], \\\",\\\", RowBox[{\\\"34\\\", \\\"\[Rule]\\\", \
RowBox[{\\\"{\\\", \\\"}\\\"}]}], \\\",\\\", RowBox[{\\\"35\\\", \
\\\"\[Rule]\\\", RowBox[{\\\"{\\\", \\\"}\\\"}]}], \\\",\\\", \
RowBox[{\\\"36\\\", \\\"\[Rule]\\\", RowBox[{\\\"{\\\", \\\"}\\\"}]}], \
\\\",\\\", RowBox[{\\\"37\\\", \\\"\[Rule]\\\", RowBox[{\\\"{\\\", \
\\\"}\\\"}]}], \\\",\\\", RowBox[{\\\"38\\\", \\\"\[Rule]\\\", \
RowBox[{\\\"{\\\", \\\"}\\\"}]}], \\\",\\\", RowBox[{\\\"39\\\", \
\\\"\[Rule]\\\", RowBox[{\\\"{\\\", \\\"}\\\"}]}], \\\",\\\", \
RowBox[{\\\"40\\\", \\\"\[Rule]\\\", RowBox[{\\\"{\\\", \\\"}\\\"}]}], \
\\\",\\\", RowBox[{\\\"41\\\", \\\"\[Rule]\\\", RowBox[{\\\"{\\\", \
\\\"}\\\"}]}], \\\",\\\", RowBox[{\\\"42\\\", \\\"\[Rule]\\\", \
RowBox[{\\\"{\\\", \\\"}\\\"}]}], \\\",\\\", RowBox[{\\\"43\\\", \
\\\"\[Rule]\\\", RowBox[{\\\"{\\\", \\\"}\\\"}]}], \\\",\\\", \
RowBox[{\\\"44\\\", \\\"\[Rule]\\\", RowBox[{\\\"{\\\", \\\"}\\\"}]}], \
\\\",\\\", RowBox[{\\\"45\\\", \\\"\[Rule]\\\", RowBox[{\\\"{\\\", \
\\\"}\\\"}]}], \\\",\\\", RowBox[{\\\"46\\\", \\\"\[Rule]\\\", \
RowBox[{\\\"{\\\", \\\"}\\\"}]}], \\\",\\\", RowBox[{\\\"47\\\", \
\\\"\[Rule]\\\", RowBox[{\\\"{\\\", \\\"}\\\"}]}], \\\",\\\", \
RowBox[{\\\"48\\\", \\\"\[Rule]\\\", RowBox[{\\\"{\\\", \\\"}\\\"}]}], \
\\\",\\\", RowBox[{\\\"49\\\", \\\"\[Rule]\\\", RowBox[{\\\"{\\\", \
\\\"}\\\"}]}], \\\",\\\", RowBox[{\\\"50\\\", \\\"\[Rule]\\\", \
RowBox[{\\\"{\\\", \\\"}\\\"}]}], \\\",\\\", RowBox[{\\\"51\\\", \
\\\"\[Rule]\\\", RowBox[{\\\"{\\\", \\\"}\\\"}]}]}], \
\\\"\[RightAssociation]\\\"}], \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\
\"1\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \\\"\[RightSkeleton]\\\"}]}], \
\\\"]\\\"}]}], \\\"&\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"1\\\", \\\"\[RightSkeleton]\\\"}], \\\"}\\\"}]}], \\\
\"]\\\"}], \\\"]\\\"}]\\) is not a valid Association or a list of rules.\"", 
   2, 24, 74, 26978987633308464836, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.821096624986668*^9, 3.821096718349229*^9, {3.8210968560471153`*^9, 
   3.821096860206291*^9}},
 CellLabel->
  "During evaluation of \
In[24]:=",ExpressionUUID->"5a246352-c6e4-4860-b132-a7e6313a6188"],

Cell[BoxData[
 TemplateBox[{
  "MapThread", "mptd", 
   "\"Object \\!\\(\\*RowBox[{RowBox[{\\\"NearestFunction\\\", \\\"[\\\", \
RowBox[{\\\"Hold\\\", \\\"[\\\", RowBox[{\\\"Nearest\\\", \\\"[\\\", RowBox[{\
\\\"\[LeftAssociation]\\\", RowBox[{RowBox[{\\\"1\\\", \\\"\[Rule]\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"582169.683534927`\\\", \\\",\\\", \
\\\"6.56364145974907`*^6\\\"}], \\\"}\\\"}]}], \\\",\\\", RowBox[{\\\"2\\\", \
\\\"\[Rule]\\\", RowBox[{\\\"{\\\", RowBox[{\\\"583787.828988686`\\\", \
\\\",\\\", \\\"6.56361661308255`*^6\\\"}], \\\"}\\\"}]}], \\\",\\\", RowBox[{\
\\\"3\\\", \\\"\[Rule]\\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"582200.437801118`\\\", \\\",\\\", \\\"6.56369034120651`*^6\\\"}], \
\\\"}\\\"}]}], \\\",\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"44\\\", \\\"\
\[RightSkeleton]\\\"}], \\\",\\\", RowBox[{\\\"48\\\", \\\"\[Rule]\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"580685.338425181`\\\", \\\",\\\", \
\\\"6.56356057973464`*^6\\\"}], \\\"}\\\"}]}], \\\",\\\", RowBox[{\\\"49\\\", \
\\\"\[Rule]\\\", RowBox[{\\\"{\\\", RowBox[{\\\"580684.798941444`\\\", \
\\\",\\\", \\\"6.56356491603506`*^6\\\"}], \\\"}\\\"}]}], \\\",\\\", RowBox[{\
\\\"51\\\", \\\"\[Rule]\\\", RowBox[{\\\"{\\\", RowBox[{\\\"580684.740462218`\
\\\", \\\",\\\", \\\"6.56355723697336`*^6\\\"}], \\\"}\\\"}]}]}], \\\"\
\[RightAssociation]\\\"}], \\\"]\\\"}], \\\"]\\\"}], \\\"]\\\"}], \\\"[\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"17\\\", \\\"\[RightSkeleton]\\\"}], \\\",\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"20\\\", \\\"\[RightSkeleton]\\\"}]}], \\\
\"}\\\"}], \\\",\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"47\\\", \\\"\
\[RightSkeleton]\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"1\\\", \\\"\[RightSkeleton]\\\"}], \\\"}\\\"}]}], \\\
\"}\\\"}], \\\",\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \\\"\
\[RightSkeleton]\\\"}]}], \\\"]\\\"}]\\) at position {2, \
\\!\\(\\*RowBox[{\\\"1\\\"}]\\)} in \\!\\(\\*RowBox[{\\\"MapThread\\\", \\\"[\
\\\", RowBox[{RowBox[{RowBox[{\\\"#2\\\", \\\"\[Rule]\\\", RowBox[{\\\"With\\\
\", \\\"[\\\", RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"prevNeighbors$\\\", \
\\\"=\\\", RowBox[{RowBox[{\\\"\[LeftAssociation]\\\", \
RowBox[{RowBox[{\\\"1\\\", \\\"\[Rule]\\\", RowBox[{\\\"{\\\", \\\"}\\\"}]}], \
\\\",\\\", RowBox[{\\\"2\\\", \\\"\[Rule]\\\", RowBox[{\\\"{\\\", \
\\\"}\\\"}]}], \\\",\\\", RowBox[{\\\"3\\\", \\\"\[Rule]\\\", RowBox[{\\\"{\\\
\", \\\"}\\\"}]}], \\\",\\\", RowBox[{\\\"4\\\", \\\"\[Rule]\\\", \
RowBox[{\\\"{\\\", \\\"}\\\"}]}], \\\",\\\", RowBox[{\\\"5\\\", \\\"\[Rule]\\\
\", RowBox[{\\\"{\\\", \\\"}\\\"}]}], \\\",\\\", RowBox[{\\\"6\\\", \\\"\
\[Rule]\\\", RowBox[{\\\"{\\\", \\\"}\\\"}]}], \\\",\\\", RowBox[{\\\"7\\\", \
\\\"\[Rule]\\\", RowBox[{\\\"{\\\", \\\"}\\\"}]}], \\\",\\\", RowBox[{\\\"8\\\
\", \\\"\[Rule]\\\", RowBox[{\\\"{\\\", \\\"}\\\"}]}], \\\",\\\", \
RowBox[{\\\"9\\\", \\\"\[Rule]\\\", RowBox[{\\\"{\\\", \\\"}\\\"}]}], \\\",\\\
\", RowBox[{\\\"10\\\", \\\"\[Rule]\\\", RowBox[{\\\"{\\\", \\\"}\\\"}]}], \\\
\",\\\", RowBox[{\\\"11\\\", \\\"\[Rule]\\\", RowBox[{\\\"{\\\", \
\\\"}\\\"}]}], \\\",\\\", RowBox[{\\\"12\\\", \\\"\[Rule]\\\", \
RowBox[{\\\"{\\\", \\\"}\\\"}]}], \\\",\\\", RowBox[{\\\"13\\\", \
\\\"\[Rule]\\\", RowBox[{\\\"{\\\", \\\"}\\\"}]}], \\\",\\\", \
RowBox[{\\\"14\\\", \\\"\[Rule]\\\", RowBox[{\\\"{\\\", \\\"}\\\"}]}], \
\\\",\\\", RowBox[{\\\"15\\\", \\\"\[Rule]\\\", RowBox[{\\\"{\\\", \
\\\"}\\\"}]}], \\\",\\\", RowBox[{\\\"16\\\", \\\"\[Rule]\\\", \
RowBox[{\\\"{\\\", \\\"}\\\"}]}], \\\",\\\", RowBox[{\\\"17\\\", \
\\\"\[Rule]\\\", RowBox[{\\\"{\\\", \\\"}\\\"}]}], \\\",\\\", \
RowBox[{\\\"18\\\", \\\"\[Rule]\\\", RowBox[{\\\"{\\\", \\\"}\\\"}]}], \
\\\",\\\", RowBox[{\\\"19\\\", \\\"\[Rule]\\\", RowBox[{\\\"{\\\", \
\\\"}\\\"}]}], \\\",\\\", RowBox[{\\\"20\\\", \\\"\[Rule]\\\", \
RowBox[{\\\"{\\\", \\\"}\\\"}]}], \\\",\\\", RowBox[{\\\"21\\\", \
\\\"\[Rule]\\\", RowBox[{\\\"{\\\", \\\"}\\\"}]}], \\\",\\\", \
RowBox[{\\\"22\\\", \\\"\[Rule]\\\", RowBox[{\\\"{\\\", \\\"}\\\"}]}], \
\\\",\\\", RowBox[{\\\"23\\\", \\\"\[Rule]\\\", RowBox[{\\\"{\\\", \
\\\"}\\\"}]}], \\\",\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"5\\\", \\\"\
\[RightSkeleton]\\\"}], \\\",\\\", RowBox[{\\\"29\\\", \\\"\[Rule]\\\", \
RowBox[{\\\"{\\\", \\\"}\\\"}]}], \\\",\\\", RowBox[{\\\"30\\\", \
\\\"\[Rule]\\\", RowBox[{\\\"{\\\", \\\"}\\\"}]}], \\\",\\\", \
RowBox[{\\\"31\\\", \\\"\[Rule]\\\", RowBox[{\\\"{\\\", \\\"}\\\"}]}], \
\\\",\\\", RowBox[{\\\"32\\\", \\\"\[Rule]\\\", RowBox[{\\\"{\\\", \
\\\"}\\\"}]}], \\\",\\\", RowBox[{\\\"33\\\", \\\"\[Rule]\\\", \
RowBox[{\\\"{\\\", \\\"}\\\"}]}], \\\",\\\", RowBox[{\\\"34\\\", \
\\\"\[Rule]\\\", RowBox[{\\\"{\\\", \\\"}\\\"}]}], \\\",\\\", \
RowBox[{\\\"35\\\", \\\"\[Rule]\\\", RowBox[{\\\"{\\\", \\\"}\\\"}]}], \
\\\",\\\", RowBox[{\\\"36\\\", \\\"\[Rule]\\\", RowBox[{\\\"{\\\", \
\\\"}\\\"}]}], \\\",\\\", RowBox[{\\\"37\\\", \\\"\[Rule]\\\", \
RowBox[{\\\"{\\\", \\\"}\\\"}]}], \\\",\\\", RowBox[{\\\"38\\\", \
\\\"\[Rule]\\\", RowBox[{\\\"{\\\", \\\"}\\\"}]}], \\\",\\\", \
RowBox[{\\\"39\\\", \\\"\[Rule]\\\", RowBox[{\\\"{\\\", \\\"}\\\"}]}], \
\\\",\\\", RowBox[{\\\"40\\\", \\\"\[Rule]\\\", RowBox[{\\\"{\\\", \
\\\"}\\\"}]}], \\\",\\\", RowBox[{\\\"41\\\", \\\"\[Rule]\\\", \
RowBox[{\\\"{\\\", \\\"}\\\"}]}], \\\",\\\", RowBox[{\\\"42\\\", \
\\\"\[Rule]\\\", RowBox[{\\\"{\\\", \\\"}\\\"}]}], \\\",\\\", \
RowBox[{\\\"43\\\", \\\"\[Rule]\\\", RowBox[{\\\"{\\\", \\\"}\\\"}]}], \
\\\",\\\", RowBox[{\\\"44\\\", \\\"\[Rule]\\\", RowBox[{\\\"{\\\", \
\\\"}\\\"}]}], \\\",\\\", RowBox[{\\\"45\\\", \\\"\[Rule]\\\", \
RowBox[{\\\"{\\\", \\\"}\\\"}]}], \\\",\\\", RowBox[{\\\"46\\\", \
\\\"\[Rule]\\\", RowBox[{\\\"{\\\", \\\"}\\\"}]}], \\\",\\\", \
RowBox[{\\\"47\\\", \\\"\[Rule]\\\", RowBox[{\\\"{\\\", \\\"}\\\"}]}], \
\\\",\\\", RowBox[{\\\"48\\\", \\\"\[Rule]\\\", RowBox[{\\\"{\\\", \
\\\"}\\\"}]}], \\\",\\\", RowBox[{\\\"49\\\", \\\"\[Rule]\\\", \
RowBox[{\\\"{\\\", \\\"}\\\"}]}], \\\",\\\", RowBox[{\\\"50\\\", \
\\\"\[Rule]\\\", RowBox[{\\\"{\\\", \\\"}\\\"}]}], \\\",\\\", \
RowBox[{\\\"51\\\", \\\"\[Rule]\\\", RowBox[{\\\"{\\\", \\\"}\\\"}]}]}], \\\"\
\[RightAssociation]\\\"}], \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"1\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \\\"\[RightSkeleton]\\\"}]}], \
\\\"]\\\"}]}], \\\"&\\\"}], \\\",\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\
\\\", \\\"\[RightSkeleton]\\\"}]}], \\\"]\\\"}]\\) has only \\!\\(\\*RowBox[{\
\\\"0\\\"}]\\) of required \\!\\(\\*RowBox[{\\\"1\\\"}]\\) dimensions.\"", 2, 
   24, 75, 26978987633308464836, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.821096624986668*^9, 3.821096718349229*^9, {3.8210968560471153`*^9, 
   3.821096860215173*^9}},
 CellLabel->
  "During evaluation of \
In[24]:=",ExpressionUUID->"e432011d-37d3-4b21-8467-f64c9bb47d90"],

Cell[BoxData[
 TemplateBox[{
  "General", "stop", 
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"MapThread\\\", \\\"::\\\
\", \\\"mptd\\\"}], \\\"MessageName\\\"]\\) will be suppressed during this \
calculation.\"", 2, 24, 76, 26978987633308464836, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.821096624986668*^9, 3.821096718349229*^9, {3.8210968560471153`*^9, 
   3.821096860225483*^9}},
 CellLabel->
  "During evaluation of \
In[24]:=",ExpressionUUID->"79aeeec5-f384-4853-aa59-1438a2d502bb"],

Cell[BoxData[
 TemplateBox[{
  "Part", "partd1", 
   "\"Depth of object \\!\\(\\*RowBox[{\\\"{\\\", \\\"1\\\", \\\"}\\\"}]\\) \
is not sufficient for the given part specification.\"", 2, 24, 77, 
   26978987633308464836, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.821096624986668*^9, 3.821096718349229*^9, {3.8210968560471153`*^9, 
   3.821096860233127*^9}},
 CellLabel->
  "During evaluation of \
In[24]:=",ExpressionUUID->"e4b009e7-f8e3-4195-9704-034bf0e12058"],

Cell[BoxData[
 TemplateBox[{
  "ConnectedComponents", "graph", 
   "\"A graph object is expected at position \\!\\(\\*RowBox[{\\\"1\\\"}]\\) \
in \\!\\(\\*RowBox[{\\\"ConnectedComponents\\\", \\\"[\\\", \
RowBox[{\\\"Catenate\\\", \\\"[\\\", RowBox[{\\\"MapThread\\\", \\\"[\\\", \
RowBox[{RowBox[{RowBox[{\\\"Thread\\\", \\\"[\\\", RowBox[{\\\"#1\\\", \\\"\
\[Rule]\\\", \\\"#2\\\"}], \\\"]\\\"}], \\\"&\\\"}], \\\",\\\", RowBox[{\\\"{\
\\\", RowBox[{RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"{\\\", \\\"1\\\", \
\\\"}\\\"}], \\\"}\\\"}], \\\"\[LeftDoubleBracket]\\\", RowBox[{\\\"All\\\", \
\\\",\\\", \\\"1\\\", \\\",\\\", \\\"1\\\"}], \
\\\"\[RightDoubleBracket]\\\"}], \\\",\\\", RowBox[{\\\"Missing\\\", \
\\\"[\\\", RowBox[{\\\"\\\\\\\"KeyAbsent\\\\\\\"\\\", \\\",\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \\\"\[RightSkeleton]\\\"}], \\\"}\
\\\"}], \\\"}\\\"}], \\\"\[LeftDoubleBracket]\\\", RowBox[{\\\"All\\\", \\\",\
\\\", \\\"1\\\", \\\",\\\", \\\"1\\\"}], \\\"\[RightDoubleBracket]\\\"}]}], \
\\\"]\\\"}]}], \\\"}\\\"}]}], \\\"]\\\"}], \\\"]\\\"}], \\\"]\\\"}]\\).\"", 2,
    24, 78, 26978987633308464836, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.821096624986668*^9, 3.821096718349229*^9, {3.8210968560471153`*^9, 
   3.8210968602410192`*^9}},
 CellLabel->
  "During evaluation of \
In[24]:=",ExpressionUUID->"501f4861-da76-46b1-a15b-ece1f765bfc5"],

Cell[BoxData[
 TemplateBox[{
  "Complement", "heads", 
   "\"Heads \\!\\(\\*RowBox[{\\\"Part\\\"}]\\) and \
\\!\\(\\*RowBox[{\\\"List\\\"}]\\) at positions \
\\!\\(\\*RowBox[{\\\"2\\\"}]\\) and \\!\\(\\*RowBox[{\\\"1\\\"}]\\) are \
expected to be the same.\"", 2, 24, 79, 26978987633308464836, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.821096624986668*^9, 3.821096718349229*^9, {3.8210968560471153`*^9, 
   3.821096860249383*^9}},
 CellLabel->
  "During evaluation of \
In[24]:=",ExpressionUUID->"703791eb-44fc-4c83-bad2-2b66253a6168"],

Cell[BoxData[
 TemplateBox[{
  "Lookup", "invrl", 
   "\"The argument \\!\\(\\*RowBox[{\\\"Association\\\", \\\"[\\\", \
RowBox[{\\\"Catenate\\\", \\\"[\\\", RowBox[{\\\"MapIndexed\\\", \\\"[\\\", \
RowBox[{RowBox[{RowBox[{\\\"Thread\\\", \\\"[\\\", RowBox[{\\\"#1\\\", \\\"\
\[Rule]\\\", RowBox[{\\\"First\\\", \\\"[\\\", RowBox[{\\\"Slot\\\", \
\\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \\\"\[RightSkeleton]\\\
\"}], \\\"]\\\"}], \\\"]\\\"}]}], \\\"]\\\"}], \\\"&\\\"}], \\\",\\\", \
\\\"clusterCores$12207\\\"}], \\\"]\\\"}], \\\"]\\\"}], \\\"]\\\"}]\\) is not \
a valid Association or a list of rules.\"", 2, 24, 80, 26978987633308464836, 
   "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.821096624986668*^9, 3.821096718349229*^9, {3.8210968560471153`*^9, 
   3.821096860255837*^9}},
 CellLabel->
  "During evaluation of \
In[24]:=",ExpressionUUID->"87453195-8c74-480f-a321-e389717a2bf2"],

Cell[BoxData[
 TemplateBox[{
  "Lookup", "invrl", 
   "\"The argument \\!\\(\\*RowBox[{\\\"Association\\\", \\\"[\\\", \
RowBox[{\\\"Catenate\\\", \\\"[\\\", RowBox[{\\\"MapIndexed\\\", \\\"[\\\", \
RowBox[{RowBox[{RowBox[{\\\"Thread\\\", \\\"[\\\", RowBox[{\\\"#1\\\", \\\"\
\[Rule]\\\", RowBox[{\\\"First\\\", \\\"[\\\", RowBox[{\\\"Slot\\\", \
\\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \\\"\[RightSkeleton]\\\
\"}], \\\"]\\\"}], \\\"]\\\"}]}], \\\"]\\\"}], \\\"&\\\"}], \\\",\\\", \
\\\"clusterCores$12207\\\"}], \\\"]\\\"}], \\\"]\\\"}], \\\"]\\\"}]\\) is not \
a valid Association or a list of rules.\"", 2, 24, 81, 26978987633308464836, 
   "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.821096624986668*^9, 3.821096718349229*^9, {3.8210968560471153`*^9, 
   3.821096860262927*^9}},
 CellLabel->
  "During evaluation of \
In[24]:=",ExpressionUUID->"a0655486-f74a-4896-a2f4-f15225765ed9"],

Cell[BoxData[
 TemplateBox[{
  "General", "stop", 
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"Lookup\\\", \\\"::\\\", \
\\\"invrl\\\"}], \\\"MessageName\\\"]\\) will be suppressed during this \
calculation.\"", 2, 24, 82, 26978987633308464836, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.821096624986668*^9, 3.821096718349229*^9, {3.8210968560471153`*^9, 
   3.821096860269619*^9}},
 CellLabel->
  "During evaluation of \
In[24]:=",ExpressionUUID->"a9a07f3a-4a71-4d6e-9a77-c8133b934ef5"],

Cell[BoxData[
 TemplateBox[{
  "Merge", "list1", 
   "\"The argument \\!\\(\\*RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"1\\\", \
\\\",\\\", \\\"2\\\", \\\",\\\", \\\"3\\\", \\\",\\\", \\\"4\\\", \\\",\\\", \
\\\"5\\\", \\\",\\\", \\\"6\\\", \\\",\\\", \\\"7\\\", \\\",\\\", \\\"8\\\", \
\\\",\\\", \\\"9\\\", \\\",\\\", \\\"10\\\", \\\",\\\", \\\"11\\\", \
\\\",\\\", \\\"12\\\", \\\",\\\", \\\"13\\\", \\\",\\\", \\\"14\\\", \
\\\",\\\", \\\"15\\\", \\\",\\\", \\\"16\\\", \\\",\\\", \\\"17\\\", \
\\\",\\\", \\\"18\\\", \\\",\\\", \\\"19\\\", \\\",\\\", \\\"20\\\", \
\\\",\\\", \\\"21\\\", \\\",\\\", \\\"22\\\", \\\",\\\", \\\"23\\\", \
\\\",\\\", \\\"24\\\", \\\",\\\", \\\"25\\\", \\\",\\\", \\\"26\\\", \
\\\",\\\", \\\"27\\\", \\\",\\\", \\\"28\\\", \\\",\\\", \\\"29\\\", \
\\\",\\\", \\\"30\\\", \\\",\\\", \\\"31\\\", \\\",\\\", \\\"32\\\", \
\\\",\\\", \\\"33\\\", \\\",\\\", \\\"34\\\", \\\",\\\", \\\"35\\\", \
\\\",\\\", \\\"36\\\", \\\",\\\", \\\"37\\\", \\\",\\\", \\\"38\\\", \
\\\",\\\", \\\"39\\\", \\\",\\\", \\\"40\\\", \\\",\\\", \\\"41\\\", \
\\\",\\\", \\\"42\\\", \\\",\\\", \\\"43\\\", \\\",\\\", \\\"44\\\", \
\\\",\\\", \\\"45\\\", \\\",\\\", \\\"46\\\", \\\",\\\", \\\"47\\\", \
\\\",\\\", \\\"48\\\", \\\",\\\", \\\"49\\\", \\\",\\\", \\\"51\\\"}], \
\\\"}\\\"}], \\\"\[Rule]\\\", RowBox[{\\\"Lookup\\\", \\\"[\\\", \
RowBox[{\\\"coreClusters$12207\\\", \\\",\\\", \
RowBox[{\\\"pointNeighbors$12207\\\", \\\"[\\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"1\\\", \\\",\\\", \\\"2\\\", \\\",\\\", \\\"3\\\", \\\",\\\", \
\\\"4\\\", \\\",\\\", \\\"5\\\", \\\",\\\", \\\"6\\\", \\\",\\\", \\\"7\\\", \
\\\",\\\", \\\"8\\\", \\\",\\\", \\\"9\\\", \\\",\\\", \\\"10\\\", \\\",\\\", \
\\\"11\\\", \\\",\\\", \\\"12\\\", \\\",\\\", \\\"13\\\", \\\",\\\", \\\"14\\\
\", \\\",\\\", \\\"15\\\", \\\",\\\", \\\"16\\\", \\\",\\\", \\\"17\\\", \
\\\",\\\", \\\"18\\\", \\\",\\\", \\\"19\\\", \\\",\\\", \\\"20\\\", \
\\\",\\\", \\\"21\\\", \\\",\\\", \\\"22\\\", \\\",\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"7\\\", \\\"\[RightSkeleton]\\\"}], \\\",\\\", \\\"30\
\\\", \\\",\\\", \\\"31\\\", \\\",\\\", \\\"32\\\", \\\",\\\", \\\"33\\\", \\\
\",\\\", \\\"34\\\", \\\",\\\", \\\"35\\\", \\\",\\\", \\\"36\\\", \\\",\\\", \
\\\"37\\\", \\\",\\\", \\\"38\\\", \\\",\\\", \\\"39\\\", \\\",\\\", \\\"40\\\
\", \\\",\\\", \\\"41\\\", \\\",\\\", \\\"42\\\", \\\",\\\", \\\"43\\\", \
\\\",\\\", \\\"44\\\", \\\",\\\", \\\"45\\\", \\\",\\\", \\\"46\\\", \
\\\",\\\", \\\"47\\\", \\\",\\\", \\\"48\\\", \\\",\\\", \\\"49\\\", \
\\\",\\\", \\\"51\\\"}], \\\"}\\\"}], \\\"]\\\"}], \\\",\\\", \
\\\"Nothing\\\"}], \\\"]\\\"}]}]\\) is not a valid list of Associations or \
rules or lists of rules.\"", 2, 24, 83, 26978987633308464836, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.821096624986668*^9, 3.821096718349229*^9, {3.8210968560471153`*^9, 
   3.8210968602765017`*^9}},
 CellLabel->
  "During evaluation of \
In[24]:=",ExpressionUUID->"07bd914c-492b-4b3b-a599-d29dc6573711"],

Cell[BoxData[
 TemplateBox[{
  "KeyDrop", "invrl", 
   "\"The argument \\!\\(\\*RowBox[{\\\"Merge\\\", \\\"[\\\", \
RowBox[{RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"1\\\", \\\",\\\", \\\"2\\\", \
\\\",\\\", \\\"3\\\", \\\",\\\", \\\"4\\\", \\\",\\\", \\\"5\\\", \\\",\\\", \
\\\"6\\\", \\\",\\\", \\\"7\\\", \\\",\\\", \\\"8\\\", \\\",\\\", \\\"9\\\", \
\\\",\\\", \\\"10\\\", \\\",\\\", \\\"11\\\", \\\",\\\", \\\"12\\\", \
\\\",\\\", \\\"13\\\", \\\",\\\", \\\"14\\\", \\\",\\\", \\\"15\\\", \
\\\",\\\", \\\"16\\\", \\\",\\\", \\\"17\\\", \\\",\\\", \\\"18\\\", \
\\\",\\\", \\\"19\\\", \\\",\\\", \\\"20\\\", \\\",\\\", \\\"21\\\", \
\\\",\\\", \\\"22\\\", \\\",\\\", \\\"23\\\", \\\",\\\", \\\"24\\\", \
\\\",\\\", \\\"25\\\", \\\",\\\", \\\"26\\\", \\\",\\\", \\\"27\\\", \
\\\",\\\", \\\"28\\\", \\\",\\\", \\\"29\\\", \\\",\\\", \\\"30\\\", \
\\\",\\\", \\\"31\\\", \\\",\\\", \\\"32\\\", \\\",\\\", \\\"33\\\", \
\\\",\\\", \\\"34\\\", \\\",\\\", \\\"35\\\", \\\",\\\", \\\"36\\\", \
\\\",\\\", \\\"37\\\", \\\",\\\", \\\"38\\\", \\\",\\\", \\\"39\\\", \
\\\",\\\", \\\"40\\\", \\\",\\\", \\\"41\\\", \\\",\\\", \\\"42\\\", \
\\\",\\\", \\\"43\\\", \\\",\\\", \\\"44\\\", \\\",\\\", \\\"45\\\", \
\\\",\\\", \\\"46\\\", \\\",\\\", \\\"47\\\", \\\",\\\", \\\"48\\\", \
\\\",\\\", \\\"49\\\", \\\",\\\", \\\"51\\\"}], \\\"}\\\"}], \\\"\[Rule]\\\", \
RowBox[{\\\"Lookup\\\", \\\"[\\\", RowBox[{\\\"coreClusters$12207\\\", \
\\\",\\\", RowBox[{\\\"pointNeighbors$12207\\\", \\\"[\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"1\\\", \\\",\\\", \\\"2\\\", \\\",\\\", \
\\\"3\\\", \\\",\\\", \\\"4\\\", \\\",\\\", \\\"5\\\", \\\",\\\", \\\"6\\\", \
\\\",\\\", \\\"7\\\", \\\",\\\", \\\"8\\\", \\\",\\\", \\\"9\\\", \\\",\\\", \
\\\"10\\\", \\\",\\\", \\\"11\\\", \\\",\\\", \\\"12\\\", \\\",\\\", \\\"13\\\
\", \\\",\\\", \\\"14\\\", \\\",\\\", \\\"15\\\", \\\",\\\", \\\"16\\\", \
\\\",\\\", \\\"17\\\", \\\",\\\", \\\"18\\\", \\\",\\\", \\\"19\\\", \
\\\",\\\", \\\"20\\\", \\\",\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"10\\\", \\\"\[RightSkeleton]\\\"}], \\\",\\\", \\\"31\\\", \\\",\\\", \
\\\"32\\\", \\\",\\\", \\\"33\\\", \\\",\\\", \\\"34\\\", \\\",\\\", \\\"35\\\
\", \\\",\\\", \\\"36\\\", \\\",\\\", \\\"37\\\", \\\",\\\", \\\"38\\\", \
\\\",\\\", \\\"39\\\", \\\",\\\", \\\"40\\\", \\\",\\\", \\\"41\\\", \
\\\",\\\", \\\"42\\\", \\\",\\\", \\\"43\\\", \\\",\\\", \\\"44\\\", \
\\\",\\\", \\\"45\\\", \\\",\\\", \\\"46\\\", \\\",\\\", \\\"47\\\", \
\\\",\\\", \\\"48\\\", \\\",\\\", \\\"49\\\", \\\",\\\", \\\"51\\\"}], \
\\\"}\\\"}], \\\"]\\\"}], \\\",\\\", \\\"Nothing\\\"}], \\\"]\\\"}]}], \
\\\",\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"8\\\", \\\"\[RightSkeleton]\\\
\"}]}], \\\"]\\\"}]\\) is not a valid Association or a list of rules.\"", 2, 
   24, 84, 26978987633308464836, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.821096624986668*^9, 3.821096718349229*^9, {3.8210968560471153`*^9, 
   3.821096860284082*^9}},
 CellLabel->
  "During evaluation of \
In[24]:=",ExpressionUUID->"d9e2750f-006a-46fe-affc-06b231ce0601"],

Cell[BoxData[
 TemplateBox[{
  "KeyValueMap", "invak", 
   "\"The argument \\!\\(\\*RowBox[{\\\"KeyDrop\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"Merge\\\", \\\"[\\\", RowBox[{RowBox[{RowBox[{\\\"{\\\", \
RowBox[{\\\"1\\\", \\\",\\\", \\\"2\\\", \\\",\\\", \\\"3\\\", \\\",\\\", \
\\\"4\\\", \\\",\\\", \\\"5\\\", \\\",\\\", \\\"6\\\", \\\",\\\", \\\"7\\\", \
\\\",\\\", \\\"8\\\", \\\",\\\", \\\"9\\\", \\\",\\\", \\\"10\\\", \\\",\\\", \
\\\"11\\\", \\\",\\\", \\\"12\\\", \\\",\\\", \\\"13\\\", \\\",\\\", \\\"14\\\
\", \\\",\\\", \\\"15\\\", \\\",\\\", \\\"16\\\", \\\",\\\", \\\"17\\\", \
\\\",\\\", \\\"18\\\", \\\",\\\", \\\"19\\\", \\\",\\\", \\\"20\\\", \
\\\",\\\", \\\"21\\\", \\\",\\\", \\\"22\\\", \\\",\\\", \\\"23\\\", \
\\\",\\\", \\\"24\\\", \\\",\\\", \\\"25\\\", \\\",\\\", \\\"26\\\", \
\\\",\\\", \\\"27\\\", \\\",\\\", \\\"28\\\", \\\",\\\", \\\"29\\\", \
\\\",\\\", \\\"30\\\", \\\",\\\", \\\"31\\\", \\\",\\\", \\\"32\\\", \
\\\",\\\", \\\"33\\\", \\\",\\\", \\\"34\\\", \\\",\\\", \\\"35\\\", \
\\\",\\\", \\\"36\\\", \\\",\\\", \\\"37\\\", \\\",\\\", \\\"38\\\", \
\\\",\\\", \\\"39\\\", \\\",\\\", \\\"40\\\", \\\",\\\", \\\"41\\\", \
\\\",\\\", \\\"42\\\", \\\",\\\", \\\"43\\\", \\\",\\\", \\\"44\\\", \
\\\",\\\", \\\"45\\\", \\\",\\\", \\\"46\\\", \\\",\\\", \\\"47\\\", \
\\\",\\\", \\\"48\\\", \\\",\\\", \\\"49\\\", \\\",\\\", \\\"51\\\"}], \
\\\"}\\\"}], \\\"\[Rule]\\\", RowBox[{\\\"Lookup\\\", \\\"[\\\", \
RowBox[{\\\"coreClusters$12207\\\", \\\",\\\", \
RowBox[{\\\"pointNeighbors$12207\\\", \\\"[\\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"1\\\", \\\",\\\", \\\"2\\\", \\\",\\\", \\\"3\\\", \\\",\\\", \
\\\"4\\\", \\\",\\\", \\\"5\\\", \\\",\\\", \\\"6\\\", \\\",\\\", \\\"7\\\", \
\\\",\\\", \\\"8\\\", \\\",\\\", \\\"9\\\", \\\",\\\", \\\"10\\\", \\\",\\\", \
\\\"11\\\", \\\",\\\", \\\"12\\\", \\\",\\\", \\\"13\\\", \\\",\\\", \\\"14\\\
\", \\\",\\\", \\\"15\\\", \\\",\\\", \\\"16\\\", \\\",\\\", \\\"17\\\", \
\\\",\\\", \\\"18\\\", \\\",\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"14\\\", \\\"\[RightSkeleton]\\\"}], \\\",\\\", \\\"33\\\", \\\",\\\", \
\\\"34\\\", \\\",\\\", \\\"35\\\", \\\",\\\", \\\"36\\\", \\\",\\\", \\\"37\\\
\", \\\",\\\", \\\"38\\\", \\\",\\\", \\\"39\\\", \\\",\\\", \\\"40\\\", \
\\\",\\\", \\\"41\\\", \\\",\\\", \\\"42\\\", \\\",\\\", \\\"43\\\", \
\\\",\\\", \\\"44\\\", \\\",\\\", \\\"45\\\", \\\",\\\", \\\"46\\\", \
\\\",\\\", \\\"47\\\", \\\",\\\", \\\"48\\\", \\\",\\\", \\\"49\\\", \
\\\",\\\", \\\"51\\\"}], \\\"}\\\"}], \\\"]\\\"}], \\\",\\\", \
\\\"Nothing\\\"}], \\\"]\\\"}]}], \\\",\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"8\\\", \\\"\[RightSkeleton]\\\"}]}], \\\"]\\\"}], \\\",\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"1\\\", \\\"\[RightSkeleton]\\\"}]}], \\\"]\\\"}]\\) \
is not a valid Association.\"", 2, 24, 85, 26978987633308464836, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.821096624986668*^9, 3.821096718349229*^9, {3.8210968560471153`*^9, 
   3.8210968602991333`*^9}},
 CellLabel->
  "During evaluation of \
In[24]:=",ExpressionUUID->"c6c5d5d2-1594-45ce-8321-c1af02c9b912"],

Cell[BoxData[
 TemplateBox[{
  "ConnectedComponents", "graph", 
   "\"A graph object is expected at position \\!\\(\\*RowBox[{\\\"1\\\"}]\\) \
in \\!\\(\\*RowBox[{\\\"ConnectedComponents\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"Catenate\\\", \\\"[\\\", RowBox[{\\\"MapThread\\\", \\\"[\
\\\", RowBox[{RowBox[{RowBox[{\\\"Thread\\\", \\\"[\\\", RowBox[{\\\"#1\\\", \
\\\"\[Rule]\\\", \\\"#2\\\"}], \\\"]\\\"}], \\\"&\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"{\\\", \
\\\"1\\\", \\\"}\\\"}], \\\"}\\\"}], \\\"\[LeftDoubleBracket]\\\", RowBox[{\\\
\"All\\\", \\\",\\\", \\\"1\\\", \\\",\\\", \\\"1\\\"}], \\\"\
\[RightDoubleBracket]\\\"}], \\\",\\\", RowBox[{\\\"Missing\\\", \\\"[\\\", \
RowBox[{\\\"\\\\\\\"KeyAbsent\\\\\\\"\\\", \\\",\\\", RowBox[{RowBox[{\\\"{\\\
\", RowBox[{\\\"{\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \\\"\
\[RightSkeleton]\\\"}], \\\"}\\\"}], \\\"}\\\"}], \
\\\"\[LeftDoubleBracket]\\\", RowBox[{\\\"All\\\", \\\",\\\", \\\"1\\\", \
\\\",\\\", \\\"1\\\"}], \\\"\[RightDoubleBracket]\\\"}]}], \\\"]\\\"}]}], \
\\\"}\\\"}]}], \\\"]\\\"}], \\\"]\\\"}], \\\",\\\", RowBox[{\\\"Lookup\\\", \
\\\"[\\\", RowBox[{\\\"clusterNoncores$12207\\\", \\\",\\\", \
RowBox[{\\\"Key\\\", \\\"[\\\", RowBox[{\\\"{\\\", \\\"}\\\"}], \\\"]\\\"}], \
\\\",\\\", RowBox[{\\\"{\\\", \\\"}\\\"}]}], \\\"]\\\"}]}], \
\\\"]\\\"}]\\).\"", 2, 24, 86, 26978987633308464836, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.821096624986668*^9, 3.821096718349229*^9, {3.8210968560471153`*^9, 
   3.821096860307395*^9}},
 CellLabel->
  "During evaluation of \
In[24]:=",ExpressionUUID->"18d5b0f1-f1ab-4081-945d-0afec0e17e7d"],

Cell[BoxData[
 RowBox[{"ConnectedComponents", "[", 
  RowBox[{
   RowBox[{"Catenate", "[", 
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Thread", "[", 
        RowBox[{"#1", "\[Rule]", "#2"}], "]"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"{", "1", "}"}], "}"}], "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", "1", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
        
        RowBox[{"Missing", "[", 
         RowBox[{"\<\"KeyAbsent\"\>", ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"{", "1", "}"}], "}"}], "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "1", ",", "1"}], "\[RightDoubleBracket]"}]}], 
         "]"}]}], "}"}]}], "]"}], "]"}], ",", 
   RowBox[{"Lookup", "[", 
    RowBox[{"clusterNoncores$12207", ",", 
     RowBox[{"Key", "[", 
      RowBox[{"{", "}"}], "]"}], ",", 
     RowBox[{"{", "}"}]}], "]"}]}], "]"}]], "Output",
 CellChangeTimes->{
  3.8210966251918917`*^9, 3.8210967185084867`*^9, {3.821096856151239*^9, 
   3.821096860314837*^9}},
 CellLabel->"Out[24]=",ExpressionUUID->"9ac8e8f9-4724-481a-afdb-08250c3d88ec"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Run for all sheep", "Section",
 CellChangeTimes->{{3.821096306314684*^9, 
  3.821096308418563*^9}},ExpressionUUID->"2df3749a-9328-4e70-b2b7-\
221f29860618"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dbscanSticky", "[", 
   RowBox[{"fullData_", ",", 
    RowBox[{"{", 
     RowBox[{"r1_", ",", "r2_"}], "}"}], ",", "k_", ",", 
    RowBox[{"{", 
     RowBox[{"minTime_", ",", "maxTime_"}], "}"}]}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"prevIndexClusters", ",", "clustering"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"prevIndexClusters", "=", 
      RowBox[{"Association", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "\[Rule]", 
          RowBox[{"{", "}"}]}], "&"}], "/@", 
        RowBox[{"Range", "[", 
         RowBox[{"Length", "[", 
          RowBox[{"fullData", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "minTime"}], "]"}], "]"}], "]"}], "]"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"clustering", "=", 
      RowBox[{"dbscanSticky", "[", 
       RowBox[{
        RowBox[{"fullData", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "minTime"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"r1", ",", "r2"}], "}"}], ",", "k", ",", 
        "prevIndexClusters"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"MapIndexed", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"prevIndexClusters", "=", 
        RowBox[{"Join", "[", 
         RowBox[{"prevIndexClusters", ",", 
          RowBox[{"Association", "[", 
           RowBox[{"Catenate", "[", 
            RowBox[{
             RowBox[{"Function", "[", 
              RowBox[{"c", ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"#", "\[Rule]", "c"}], "&"}], "/@", "c"}]}], "]"}], "/@",
              "clustering"}], "]"}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"clustering", "=", 
        RowBox[{"dbscanSticky", "[", 
         RowBox[{"pts", ",", 
          RowBox[{"{", 
           RowBox[{"r1", ",", "r2"}], "}"}], ",", "k", ",", 
          "prevIndexClusters"}], "]"}]}]}]}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.821096910559733*^9, 
  3.821097141771092*^9}},ExpressionUUID->"c8eb36cc-9c43-4dd2-a2f8-\
03b403cffe7b"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.821057571664921*^9, 3.821057584518093*^9}, 
   3.821057866880453*^9, 3.82109637644062*^9, 
   3.821097080406212*^9},ExpressionUUID->"e9729408-e065-4925-9c05-\
363a1b5bee86"]
}, Open  ]]
},
WindowSize->{808, 855},
WindowMargins->{{30, Automatic}, {Automatic, 0}},
FrontEndVersion->"12.1 for Mac OS X x86 (64-bit) (March 18, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"619488d7-f423-4250-be1e-be8d11f384ee"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 218, 4, 67, "Section",ExpressionUUID->"81fbbc38-d5ef-4a5b-8324-04a5f75e981c"],
Cell[801, 28, 378, 9, 73, "Input",ExpressionUUID->"70b09186-4e39-46c9-8cae-3d5dd19b0464"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1216, 42, 160, 3, 67, "Section",ExpressionUUID->"b2fc9f7d-00eb-441f-8736-15e45197167f"],
Cell[1379, 47, 11589, 270, 1249, "Input",ExpressionUUID->"353d35e9-cc91-43df-9dab-415c9f8792a7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13005, 322, 170, 3, 67, "Section",ExpressionUUID->"0a93a041-3341-4b89-852d-4dd23383b76a"],
Cell[13178, 327, 159, 3, 35, "Text",ExpressionUUID->"06eecf62-e140-4a89-8d39-397256d522d5"],
Cell[13340, 332, 366, 8, 30, "Input",ExpressionUUID->"82386423-4a0a-49d5-83f0-314785cdf620"],
Cell[CellGroupData[{
Cell[13731, 344, 308, 8, 30, "Input",ExpressionUUID->"0c254f18-c467-4bbd-a471-6ec230d14da6"],
Cell[14042, 354, 3311, 106, 119, "Output",ExpressionUUID->"f254ee4b-7f3d-4502-afa6-e0e8446d1450"]
}, Open  ]],
Cell[17368, 463, 223, 5, 35, "Text",ExpressionUUID->"21ec29fa-a08d-488e-95f2-3e7ef0d0fda3"],
Cell[CellGroupData[{
Cell[17616, 472, 684, 17, 52, "Input",ExpressionUUID->"5c815cfd-ff3f-43a5-a938-d28f19528932"],
Cell[18303, 491, 595, 13, 42, "Message",ExpressionUUID->"68b57172-cba8-4c34-998f-6f17de49f488"],
Cell[18901, 506, 565, 13, 42, "Message",ExpressionUUID->"cbac8e88-7337-438e-8eac-a9d3a33cac9c"],
Cell[19469, 521, 6996, 103, 187, "Message",ExpressionUUID->"064b7ab0-95f8-4486-99c1-96be5f8cda6b"],
Cell[26468, 626, 595, 13, 42, "Message",ExpressionUUID->"9aeebc73-5044-4c12-bf44-9c0e06d6d93d"],
Cell[27066, 641, 538, 12, 24, "Message",ExpressionUUID->"2321c92f-87a3-443f-aeef-536ded1c7684"],
Cell[27607, 655, 6996, 103, 187, "Message",ExpressionUUID->"30f68c28-25ba-4c48-b455-48a23d51a5a5"],
Cell[34606, 760, 494, 12, 24, "Message",ExpressionUUID->"428a7f88-b785-469e-b285-efba877d2123"],
Cell[35103, 774, 4928, 75, 110, "Message",ExpressionUUID->"5a246352-c6e4-4860-b132-a7e6313a6188"],
Cell[40034, 851, 6996, 103, 187, "Message",ExpressionUUID->"e432011d-37d3-4b21-8467-f64c9bb47d90"],
Cell[47033, 956, 531, 12, 24, "Message",ExpressionUUID->"79aeeec5-f384-4853-aa59-1438a2d502bb"],
Cell[47567, 970, 495, 12, 24, "Message",ExpressionUUID->"e4b009e7-f8e3-4195-9704-034bf0e12058"],
Cell[48065, 984, 1449, 25, 42, "Message",ExpressionUUID->"501f4861-da76-46b1-a15b-ece1f765bfc5"],
Cell[49517, 1011, 568, 13, 24, "Message",ExpressionUUID->"703791eb-44fc-4c83-bad2-2b66253a6168"],
Cell[50088, 1026, 934, 18, 42, "Message",ExpressionUUID->"87453195-8c74-480f-a321-e389717a2bf2"],
Cell[51025, 1046, 934, 18, 42, "Message",ExpressionUUID->"a0655486-f74a-4896-a2f4-f15225765ed9"],
Cell[51962, 1066, 529, 12, 24, "Message",ExpressionUUID->"a9a07f3a-4a71-4d6e-9a77-c8133b934ef5"],
Cell[52494, 1080, 3009, 46, 93, "Message",ExpressionUUID->"07bd914c-492b-4b3b-a599-d29dc6573711"],
Cell[55506, 1128, 3068, 47, 94, "Message",ExpressionUUID->"d9e2750f-006a-46fe-affc-06b231ce0601"],
Cell[58577, 1177, 3103, 47, 94, "Message",ExpressionUUID->"c6c5d5d2-1594-45ce-8321-c1af02c9b912"],
Cell[61683, 1226, 1692, 28, 59, "Message",ExpressionUUID->"18d5b0f1-f1ab-4081-945d-0afec0e17e7d"],
Cell[63378, 1256, 1178, 31, 77, "Output",ExpressionUUID->"9ac8e8f9-4724-481a-afdb-08250c3d88ec"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[64605, 1293, 162, 3, 67, "Section",ExpressionUUID->"2df3749a-9328-4e70-b2b7-221f29860618"],
Cell[64770, 1298, 2184, 59, 178, "Input",ExpressionUUID->"c8eb36cc-9c43-4dd2-a2f8-03b403cffe7b"],
Cell[66957, 1359, 222, 4, 30, "Input",ExpressionUUID->"e9729408-e065-4925-9c05-363a1b5bee86"]
}, Open  ]]
}
]
*)

